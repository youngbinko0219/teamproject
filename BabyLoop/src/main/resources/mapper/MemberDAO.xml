<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.babyloop.auth.member.IMemberService">


	<!-- 로그인 쿼리 -->
	<select id="login"
		parameterType="com.babyloop.auth.member.MemberDTO">
	
		SELECT user_pw
		FROM member
		WHERE user_id=#{user_id}

	</select>
	
	
	<!-- 회원가입 쿼리 -->
	<insert id="register"
		parameterType="com.babyloop.auth.member.MemberDTO">
		
		INSERT INTO member(
			user_id,user_pw, user_name, user_email,
    		user_phone, user_addr1, user_addr2, user_addr3,
    		user_gender, user_birth)
    	VALUES(
	        #{member.user_id}, #{encryptedPassword},
	        #{member.user_name}, #{member.user_email}, #{member.user_phone},
	        #{member.user_addr1}, #{member.user_addr2}, #{member.user_addr3},
	        #{member.user_gender}, #{member.user_birth}
    	)
		
	</insert>
	
	
	<!-- 아이디 중복체크 쿼리 -->
	<select id="idcheck"
		parameterType="com.babyloop.auth.member.MemberDTO">
		
		SELECT user_id
		FROM member
		WHERE user_id=#{user_id}
		
	</select>
	
	
	<!-- 아이디 찾기 쿼리 -->
	<select id="idSearch"
		parameterType="com.babyloop.auth.member.MemberDTO">
		
		SELECT user_id
		FROM member
		WHERE user_name=#{user_name} AND
			user_email=#{user_email}
		
	</select>
	
	
	<!-- 비밀번호 찾기 -->
	<select id="pwSearch"
		parameterType="com.babyloop.auth.member.MemberDTO">
		
		SELECT user_pw
		FROM member
		WHERE user_id=#{user_id} AND
			user_email=#{user_email} AND
			user_name=#{user_name}
		
	</select>
	
	
	<!-- 이미 인증한 이메일 체크 -->
	<select id="emailCheck"
		parameterType="com.babyloop.auth.member.MemberDTO">
	
		SELECT user_email
		FROM member
		WHERE user_email=#{user_email}
	
	</select>
	
	
	<!-- 임시비밀번호 저장 -->
	<update id="changePw"
		parameterType="com.babyloop.auth.member.MemberDTO">
	
		UPDATE member
		SET user_pw=#{encryptedPassword}
		WHERE user_id=#{member.user_id} AND
			user_email=#{member.user_email} AND
			user_name=#{member.user_name}
	
	</update>
	
</mapper>